{% extends "base.html" %} {% block title %}Admin Dashboard | Nexlot{% endblock
%} {% block head %}
<style>
  .dashboard-table {
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
    background-color: #fff;
  }

  .dashboard-table th {
    font-family: "Outfit", sans-serif;
    background-color: #6c40fb;
    color: white;
    text-align: center;
  }

  .dashboard-table td {
    text-align: center;
    vertical-align: middle;
  }

  .btn-info {
    background-color: #6c40fb;
    border: none;
  }

  .btn-info:hover {
    background-color: #5733cc;
  }

  .btn-danger {
    background-color: #ff4c61;
    border: none;
  }

  .btn-danger:hover {
    background-color: #e03a50;
  }

  #chartContainer {
    max-width: 400px;
    margin: 3rem auto 0;
    background: #fff;
    padding: 1.5rem;
    border-radius: 16px;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
  }

  #chartTitle {
    text-align: center;
    font-family: "Outfit", sans-serif;
    font-weight: 600;
    font-size: 1.2rem;
    margin-bottom: 1rem;
  }
</style>
{% endblock %} {% block content %}
<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Admin Dashboard</h2>
    <a
      href="{{ url_for('views.add_lot') }}"
      class="btn btn-primary px-4"
      style="background-color: #6c40fb; border: none"
    >
      + Add Lot
    </a>
  </div>

  <div class="row row-cols-1 row-cols-md-4 g-3 mb-4">
    <div class="col">
      <div class="card shadow-sm border-0 text-center p-3">
        <h5 class="mb-1">Total Lots</h5>
        <h3 class="text-primary fw-bold">{{ total_lots }}</h3>
      </div>
    </div>
    <div class="col">
      <div class="card shadow-sm border-0 text-center p-3">
        <h5 class="mb-1">Total Spots</h5>
        <h3 class="text-dark fw-bold">{{ total_spots }}</h3>
      </div>
    </div>
    <div class="col">
      <div class="card shadow-sm border-0 text-center p-3">
        <h5 class="mb-1">Available Spots</h5>
        <h3 class="text-success fw-bold">{{ available_spots }}</h3>
      </div>
    </div>
    <div class="col">
      <div class="card shadow-sm border-0 text-center p-3">
        <h5 class="mb-1">Occupied Spots</h5>
        <h3 class="text-danger fw-bold">{{ occupied_spots }}</h3>
      </div>
    </div>
  </div>

  <div class="table-responsive dashboard-table">
    <table class="table mb-0">
      <thead>
        <tr>
          <th>ID</th>
          <th>Location</th>
          <th>Address</th>
          <th>Pin Code</th>
          <th>Total Spots</th>
          <th>Available</th>
          <th>Occupied</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for lot in lots %}
        <tr>
          <td>{{ lot.id }}</td>
          <td>{{ lot.location }}</td>
          <td>{{ lot.address }}</td>
          <td>{{ lot.pin_code }}</td>
          <td>{{ lot.total_spots }}</td>
          <td>{{ lot.available_spots }}</td>
          <td>{{ lot.occupied_spots }}</td>
          <td>
            <a
              href="{{ url_for('views.view_lot', lot_id=lot.id) }}"
              class="btn btn-sm btn-info me-1"
              >View</a
            >
            <a
              href="{{ url_for('views.delete_lot', lot_id=lot.id) }}"
              class="btn btn-sm btn-danger"
              >Delete</a
            >
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Pie Chart -->
  <div id="chartContainer">
    <div id="chartTitle">Overall Parking Usage</div>
    <canvas id="spotChart" width="300" height="300"></canvas>
  </div>
</div>
{% endblock %} {% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const ctx = document.getElementById('spotChart').getContext('2d');

    const chart = new Chart(ctx, {
      type: 'pie',
      data: {
        labels: ['Available Spots', 'Occupied Spots'],
        datasets: [{
          label: 'Parking Spots',
          data: [{{ available_spots|default(0) }}, {{ occupied_spots|default(0) }}],
          backgroundColor: ['#28a745', '#FF4C61'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
          legend: {
            position: 'bottom',
            labels: {
              font: {
                family: 'Inter'
              }
            }
          }
        }
      }
    });
  });
</script>
{% endblock %}
